---
title: "Fuel consumption versus transmission type"
author: "Ilya Maltsev"
date: '23 Apr 2017'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Synopsis

Fuel consumption seems to be one of the most important aspects of car usage. 
Usually the less fuel is expended by a car the more usable the car is.

The study is focused on relationship between fuel consumption (measured as 
miles per gallon, MPG) and transmission type (automatic or manual).

The main questions are:

1. Is an automatic or manual transmission better for MPG?

2. Quantify the MPG difference between automatic and manual transmissions.

The data is used from _Motor Trend_ US magazine data.

## Exploratory data analysis

```{r, attach.libraries, message=F, warning=F}
require(datasets)
require(ggplot2)
```

### About the data

The *mtcars* dataset from *datasets* package is used:

1. *mpg* - Miles/(US) gallon.
2. *am* - transmission (0 = automatic, 1 = manual).

```{r, dataset}
data("mtcars")
head(mtcars, 3)
```

The dataset contains `r nrow(mtcars)` observations.

### *MPG* distribution

Try to verify the normality of the *mpg* data using [Shapiro-Wilk test](https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test) with 0.05 level 
of statistical significance and with distinction by cylinders count or 
by transmission type or without it.

```{r, mpg.normality.shapiro.wilk}
rbind(
    shapiro.test(mtcars$mpg[mtcars$cyl == 4]),
    shapiro.test(mtcars$mpg[mtcars$cyl == 6]),
    shapiro.test(mtcars$mpg[mtcars$cyl == 8]),
    shapiro.test(mtcars$mpg[mtcars$am == 0]),
    shapiro.test(mtcars$mpg[mtcars$am == 1]),
    shapiro.test(mtcars$mpg)
)[, c("data.name", "p.value")]
```

All the p-values are greater than 0.05 so we reject the null hypothesis that 
the data are normal.

The [Q-Q plot](https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot]) (see Appendix) 
confirms that the *mpg* data does not follow normal distibution. 

This means that Students t-test cannot be used to get statistical evidence
of *mpg* to *am* dependency.

## Modelling

```{r, fit1}
fit1 = lm(formula = mpg ~ am + wt + hp, data = mtcars)
summary(fit1)
```

## Conclusions

## Appendix

### Normality of the *MPG* data

The Q-Q plot for the *mpg* data:

```{r, mpg.normality.qq}
g = ggplot(mtcars)
g + stat_qq(aes(sample = mpg, colour = factor(am)))
g + stat_qq(aes(sample = mpg, colour = factor(cyl)))
g + stat_qq(aes(sample = mpg))
```

The plots does not look like a straight line, this confirms that the *mpg* data
does not follow normal distribution.
